---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.10.3
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Interpetting and Evaluating Naive Bayes

```{code-cell} ipython3
import pandas as pd
import seaborn as sns
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import GaussianNB
from sklearn.metrics import confusion_matrix, classification_report
iris_df = sns.load_dataset('iris')
```

```{code-cell} ipython3
iris_df.columns
```

```{code-cell} ipython3
X_train, X_test, y_train, y_test = train_test_split(iris_df[['sepal_length', 'sepal_width',
                                                            'petal_length', 'petal_width',]],
                                                   iris_df['species'],
                                           test_size=.5, random_state=0)
```

```{code-cell} ipython3
type(X_train)
```

```{code-cell} ipython3
gnb= GaussianNB()
gnb.fit(X_train,y_train)
```

```{code-cell} ipython3
gnb.__dict__
```

```{code-cell} ipython3
sns.pairplot(data=iris_df, hue='species')
```

```{code-cell} ipython3
gnb_df = pd.DataFrame(np.concatenate([np.random.multivariate_normal(mu, sig*np.eye(4),20)
                 for mu, sig in zip(gnb.theta_,gnb.sigma_)]))
gnb_df['species'] = [ci for cl in [[c]*20 for c in gnb.classes_] for ci in cl]
sns.pairplot(data =gnb_df, hue='species')
```

```{code-cell} ipython3

y_pred = gnb.predict(X_test)
```

```{code-cell} ipython3
y_pred
```

```{code-cell} ipython3
sum(y_pred == y_test)
```

```{code-cell} ipython3
len(y_test)
```

```{code-cell} ipython3
gnb.score(X_test,y_test)
```

```{code-cell} ipython3
71/75
```

```{code-cell} ipython3
confusion_matrix(y_test, y_pred,labels = gnb.classes_)
```

```{code-cell} ipython3
gnb.classes_
```

```{code-cell} ipython3
print(classification_report(y_test,y_pred))
```

```{code-cell} ipython3

```
