---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.10.3
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Evaluating CLustering

```{code-cell} ipython3
import seaborn as sns
from sklearn import datasets
from sklearn.cluster import KMeans
from sklearn import metrics
import pandas as pd
```

```{code-cell} ipython3
measurement_cols = ['sepal_length','petal_length','sepal_width','petal_width']

iris_df = sns.load_dataset('iris')
iris_X = iris_df[measurement_cols]
```

```{code-cell} ipython3
km3 = KMeans(n_clusters=3)
```

```{code-cell} ipython3
km3.fit(iris_X)
```

```{code-cell} ipython3
km3.labels_
```

# Silhouette Score


$$ s = \frac{b-a}{max(a,b)}$$

a: The mean distance between a sample and all other points in the same class.


b: The mean distance between a sample and all other points in the next nearest cluster.

```{code-cell} ipython3
metrics.silhouette_score(iris_X,km3.labels_)
```

```{code-cell} ipython3
km2 = KMeans(n_clusters=2)
km4 = KMeans(n_clusters=4)
km2.fit(iris_X)
km4.fit(iris_X)
```

```{code-cell} ipython3
metrics.silhouette_score(iris_X,km2.labels_)
```

```{code-cell} ipython3
metrics.silhouette_score(iris_X,km4.labels_)
```

```{code-cell} ipython3
iris_df['clusters3'] = km3.labels_ 
```

```{code-cell} ipython3
sns.pairplot(data= iris_df,hue= 'clusters3',)
# read docs to figure out hwy it didnt' plot clusters3
```

```{code-cell} ipython3

```
