
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>27. Model Comparison &#8212; Programming for Data Science at URI Fall 2021</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/course_admonitions.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="28. Model Selection" href="2021-11-17.html" />
    <link rel="prev" title="26. SVM and Parameter Optimizing" href="2021-11-12.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/310_2021.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Programming for Data Science at URI Fall 2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    About this Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Syllabus
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/about.html">
   Basic Facts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/tools.html">
   Tools and Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/achievements.html">
   Data Science Achievements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/grading.html">
   Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/policies.html">
   Grading Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/uri_resources.html">
   Support
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/uri_statements.html">
   General URI Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/communication.html">
   Course Communications
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Notes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-08.html">
   1. Welcome to Programming to Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-10.html">
   2. Jupyter Notebook Tour &amp; Python Review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-13.html">
   3. Getting help, object inspection, loading data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-15.html">
   4. Pandas DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-17.html">
   5. More Loading Data, Indexing, and Iterables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-20.html">
   6. Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-22.html">
   7. Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-24.html">
   8. Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-27.html">
   9. Reshaping Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-29.html">
   10. More Reshaping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-01.html">
   11. Missing Data and Inconsistent coding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-04.html">
   12. Building Datasets From multiple Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-06.html">
   13. Reviewing Merges &amp; Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-08.html">
   14. Web Scraping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-13.html">
   15. Intro to Machine learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-15.html">
   16. Interpetting and Evaluating Naive Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-18.html">
   17. Making Predictions in Generative Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-20.html">
   18. Midsemester feedback and Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-22.html">
   19. Decision Tree Setting and more Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-25.html">
   20. Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-29.html">
   21. Interpretting Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-01.html">
   22. Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-03.html">
   23. Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-05.html">
   24. Evaluating Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-08.html">
   25. ML Task Review and Cross Validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-12.html">
   26. SVM and Parameter Optimizing
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   27. Model Comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-17.html">
   28. Model Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-19.html">
   29. Learning Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-22.html">
   30. Intro to NLP- representing text data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-29.html">
   31. More NLP &amp; Solving problems with ML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-01.html">
   32. Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-03.html">
   33. Predicting with Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-06.html">
   34. Review, IDEA, &amp; Preparing for Deep Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-08.html">
   35. Neural Networks with Keras
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-10.html">
   36. Convolutional Neural Netowrks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/01-python-syllabus.html">
   1. Portfolio Setup, Data Science, and Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/02-python-access.html">
   2. Practicing Python and Accessing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/03-eda.html">
   3. Assignment 3: Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/04-prepare.html">
   4. Assignment 4:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/05-construct.html">
   5. Assignment 5: Constructing Datasets and Using Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/06-classification.html">
   6. Assignment 6: Understanding Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/07-decision-tree.html">
   7. Assignment 7: Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/08-regression.html">
   8. Assignment 8: Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/09-clustering.html">
   9. Assignment 9: Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/10-optimize.html">
   10. Assignment 10: Tuning Model Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/11-compare.html">
   11. Assignment 11: Model Comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/12-fake-news.html">
   12. Assignment 12: Fake News
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Portfolio
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/index.html">
   Portfolio Dates and Key Facts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/intro_reflection.html">
   Submission Introductions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/formatting.html">
   Formatting Tips
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/check1ideas.html">
   Portfolio Check 1 Ideas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/check2ideas.html">
   Check 2 Ideas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/check4ideas.html">
   Check 4 Ideas
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  FAQ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/index.html">
   FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/syllabus.html">
   Syllabus and Grading FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/github.html">
   Git and GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/debugging.html">
   Code Errors
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/python.html">
   References on Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/cheatsheet.html">
   Cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/datasets.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/tips.html">
   General Tips and Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/learning.html">
   How to Study in this class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/gettinghelp.html">
   Getting Help with Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/terminal.html">
   Terminals and Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/organization.html">
   Getting Organized for class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://rhodyprog4ds.github.io/BrownFall20/letters/">
   Advice from FA2020 Students
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../letters/index.html">
   Letters to Future students
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/rhodyprog4ds/BrownFall21/main?urlpath=tree/notes/2021-11-15.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownFall21/"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownFall21//issues/new?title=Issue%20on%20page%20%2Fnotes/2021-11-15.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/rhodyprog4ds/BrownFall21/edit/main/notes/2021-11-15.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notes/2021-11-15.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/notes/2021-11-15.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Model Comparison</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="model-comparison">
<h1><span class="section-number">27. </span>Model Comparison<a class="headerlink" href="#model-comparison" title="Permalink to this headline">#</a></h1>
<p>To compare models, we will first optimize the parameters of two diffrent models and look at how the different parameters settings impact the model comparison.  Later, we’ll see how to compare across models of different classes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">cluster</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="c1"># import the whole model selection module</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll use the iris data again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_X</span><span class="p">,</span> <span class="n">iris_y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Remember, we need to split the data into training and test.  The cross validation step will hep us optimize the parameters, but we don’t want <em>data leakage</em> where the model has seen the test data multiple times. So, we split the data here for train and test annd the cross validation splits the training data into train and “test” again, but this test is better termed validation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_X_train</span><span class="p">,</span> <span class="n">iris_X_test</span><span class="p">,</span> <span class="n">iris_y_train</span><span class="p">,</span> <span class="n">iris_y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">iris_X</span><span class="p">,</span><span class="n">iris_y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we can make the object, the parameter grid dictionary and the Grid Search object.  We split these into separate cells, so that we can use the built in help to see more detail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params_dt</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;criterion&#39;</span><span class="p">:[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span><span class="s1">&#39;entropy&#39;</span><span class="p">],</span>
             <span class="s1">&#39;max_depth&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
       <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">))}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_opt</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="n">params_dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we fit the Grid search using the training data, and remember this actually resets the parameters and then cross validates multiple times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_opt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris_X_train</span><span class="p">,</span><span class="n">iris_y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(estimator=DecisionTreeClassifier(),
             param_grid={&#x27;criterion&#x27;: [&#x27;gini&#x27;, &#x27;entropy&#x27;],
                         &#x27;max_depth&#x27;: [2, 3, 4],
                         &#x27;min_samples_leaf&#x27;: [2, 4, 6, 8, 10, 12, 14, 16, 18]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" ><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(estimator=DecisionTreeClassifier(),
             param_grid={&#x27;criterion&#x27;: [&#x27;gini&#x27;, &#x27;entropy&#x27;],
                         &#x27;max_depth&#x27;: [2, 3, 4],
                         &#x27;min_samples_leaf&#x27;: [2, 4, 6, 8, 10, 12, 14, 16, 18]})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" ><label for="sk-estimator-id-2" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier()</pre></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<p>adn look at the results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_opt</span><span class="o">.</span><span class="n">cv_results_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;mean_fit_time&#39;: array([0.00043321, 0.00032129, 0.00031571, 0.00031662, 0.00031571,
        0.00031385, 0.00031204, 0.00030699, 0.00032072, 0.00034666,
        0.00032516, 0.00033627, 0.00032668, 0.0003222 , 0.00034633,
        0.00032625, 0.00031881, 0.00030398, 0.00032744, 0.00033131,
        0.0003274 , 0.0003212 , 0.00032439, 0.00031896, 0.00032763,
        0.00031948, 0.00030913, 0.00032988, 0.00032773, 0.00032196,
        0.00031948, 0.00031929, 0.00031438, 0.0003191 , 0.00032115,
        0.0003253 , 0.00034261, 0.0003449 , 0.00033703, 0.00033426,
        0.00033574, 0.00033708, 0.00033274, 0.00032563, 0.00031972,
        0.0003511 , 0.00033922, 0.00033498, 0.00033283, 0.00033641,
        0.00033674, 0.00033231, 0.00032601, 0.00032163]),
 &#39;std_fit_time&#39;: array([1.90747499e-04, 9.55175172e-06, 1.05750399e-05, 8.40776282e-06,
        2.03254600e-05, 6.73944845e-06, 7.18807304e-06, 5.22697052e-06,
        1.24803871e-05, 2.69714541e-05, 7.41692571e-06, 1.39686432e-05,
        1.19983069e-05, 9.68531277e-06, 3.13034061e-05, 1.26362747e-05,
        7.45819656e-06, 8.23286661e-06, 6.32344325e-06, 1.31977982e-05,
        6.12768217e-06, 6.47937307e-06, 9.24326416e-06, 9.32018449e-06,
        1.15925380e-05, 7.07263802e-06, 7.68077951e-06, 9.42353769e-06,
        1.39694571e-05, 1.03700845e-05, 9.99312355e-06, 4.52719153e-06,
        6.05714588e-06, 4.90609593e-06, 1.02236822e-05, 1.37793563e-05,
        1.23573525e-05, 1.96365456e-05, 9.93905262e-06, 6.32595976e-06,
        1.25140459e-05, 1.60428600e-05, 1.06566437e-05, 5.79587671e-06,
        7.19534474e-06, 1.43658620e-05, 6.05864722e-06, 1.04415362e-05,
        1.07864317e-05, 6.04098294e-06, 8.55467657e-06, 6.07551170e-06,
        1.20646397e-05, 1.12588110e-05]),
 &#39;mean_score_time&#39;: array([0.00023766, 0.00020909, 0.00020151, 0.00020409, 0.0002039 ,
        0.00020552, 0.00020628, 0.00021095, 0.00021043, 0.00020976,
        0.0002068 , 0.00021029, 0.00020118, 0.00020847, 0.0002069 ,
        0.00020428, 0.00019817, 0.00019794, 0.00020814, 0.00020318,
        0.00020308, 0.00020461, 0.00020857, 0.00020566, 0.00020742,
        0.00020399, 0.00020189, 0.00020952, 0.000208  , 0.00020266,
        0.00019803, 0.00020027, 0.00020504, 0.00020485, 0.00020766,
        0.00020018, 0.00021005, 0.00020094, 0.00020413, 0.00020571,
        0.00020471, 0.00020194, 0.00020394, 0.00020475, 0.00020633,
        0.00020652, 0.00019979, 0.00020523, 0.00020723, 0.00020113,
        0.00020351, 0.00020566, 0.00019794, 0.00020137]),
 &#39;std_score_time&#39;: array([4.80251960e-05, 1.49372617e-05, 6.20145011e-06, 6.04662608e-06,
        8.26374066e-06, 8.96022571e-06, 5.96789850e-06, 1.54361255e-05,
        1.50620171e-05, 1.03281211e-05, 6.20731367e-06, 1.03760029e-05,
        5.99450879e-06, 7.93127991e-06, 4.18259854e-06, 4.83560842e-06,
        2.73257232e-06, 7.03460068e-06, 7.60551530e-06, 4.93566769e-06,
        9.18626507e-06, 7.16748270e-06, 1.46571397e-05, 1.70915360e-05,
        1.01028730e-05, 4.49746175e-06, 7.19597671e-06, 1.14841555e-05,
        8.42613220e-06, 7.01939281e-06, 4.07298212e-06, 4.61572458e-06,
        8.06263814e-06, 9.04408127e-06, 1.44198900e-05, 5.82756657e-06,
        1.39795448e-05, 7.09574708e-06, 5.62869860e-06, 6.33565692e-06,
        3.99975147e-06, 4.60339294e-06, 6.33422124e-06, 9.50019509e-06,
        6.27833580e-06, 4.95864793e-06, 3.58738763e-06, 6.38214072e-06,
        5.36182129e-06, 2.58373588e-06, 5.22044143e-06, 1.15465505e-05,
        2.76565552e-06, 4.49746175e-06]),
 &#39;param_criterion&#39;: masked_array(data=[&#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                    &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                    &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                    &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;],
              mask=[False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_max_depth&#39;: masked_array(data=[2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                    4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                    3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4],
              mask=[False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_min_samples_leaf&#39;: masked_array(data=[2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4, 6, 8, 10, 12, 14,
                    16, 18, 2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4, 6, 8, 10,
                    12, 14, 16, 18, 2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4,
                    6, 8, 10, 12, 14, 16, 18],
              mask=[False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;params&#39;: [{&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 18}],
 &#39;split0_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
        0.95833333, 0.95833333, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
        0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.95833333, 0.95833333, 0.95833333, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.95833333, 0.95833333, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667]),
 &#39;split1_test_score&#39;: array([0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
        0.875     , 0.875     , 0.875     , 0.875     , 0.95833333,
        0.95833333, 0.95833333, 0.875     , 0.875     , 0.875     ,
        0.875     , 0.875     , 0.875     , 0.95833333, 0.95833333,
        0.95833333, 0.875     , 0.875     , 0.875     , 0.875     ,
        0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
        0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
        0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
        0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
        0.95833333, 0.95833333, 0.875     , 0.875     , 0.875     ,
        0.875     , 0.875     , 0.875     , 0.875     ]),
 &#39;split2_test_score&#39;: array([0.95833333, 0.95833333, 0.91666667, 0.95833333, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.95833333, 0.95833333,
        0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
        0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
        0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
        0.91666667, 0.91666667, 0.91666667, 0.95833333, 0.95833333,
        0.91666667, 0.95833333, 0.95833333, 0.91666667, 0.91666667,
        0.91666667, 0.95833333, 0.95833333, 0.91666667, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.91666667, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667]),
 &#39;split3_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667]),
 &#39;split4_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.83333333, 0.83333333, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667]),
 &#39;mean_test_score&#39;: array([0.91666667, 0.91666667, 0.90833333, 0.91666667, 0.90833333,
        0.90833333, 0.90833333, 0.90833333, 0.91666667, 0.94166667,
        0.94166667, 0.93333333, 0.90833333, 0.90833333, 0.91666667,
        0.91666667, 0.90833333, 0.90833333, 0.925     , 0.94166667,
        0.94166667, 0.90833333, 0.90833333, 0.90833333, 0.91666667,
        0.90833333, 0.90833333, 0.90833333, 0.91666667, 0.91666667,
        0.90833333, 0.91666667, 0.91666667, 0.90833333, 0.90833333,
        0.90833333, 0.925     , 0.925     , 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.90833333, 0.91666667,
        0.91666667, 0.925     , 0.925     , 0.91666667, 0.90833333,
        0.90833333, 0.90833333, 0.90833333, 0.90833333]),
 &#39;std_test_score&#39;: array([0.02635231, 0.02635231, 0.01666667, 0.02635231, 0.01666667,
        0.01666667, 0.01666667, 0.01666667, 0.02635231, 0.02041241,
        0.02041241, 0.02041241, 0.01666667, 0.01666667, 0.02635231,
        0.02635231, 0.01666667, 0.01666667, 0.01666667, 0.02041241,
        0.02041241, 0.01666667, 0.01666667, 0.01666667, 0.02635231,
        0.01666667, 0.01666667, 0.01666667, 0.02635231, 0.02635231,
        0.01666667, 0.02635231, 0.02635231, 0.01666667, 0.01666667,
        0.01666667, 0.03118048, 0.03118048, 0.02635231, 0.02635231,
        0.02635231, 0.02635231, 0.02635231, 0.01666667, 0.02635231,
        0.04564355, 0.04859127, 0.03118048, 0.02635231, 0.01666667,
        0.01666667, 0.01666667, 0.01666667, 0.01666667]),
 &#39;rank_test_score&#39;: array([11, 11, 30, 11, 30, 30, 30, 30, 11,  1,  1,  5, 30, 30, 11, 11, 30,
        30,  6,  1,  1, 30, 30, 30, 11, 30, 30, 30, 11, 11, 30, 11, 11, 30,
        30, 30,  6,  6, 11, 11, 11, 11, 11, 30, 11, 11,  6,  6, 11, 30, 30,
        30, 30, 30], dtype=int32)}
</pre></div>
</div>
</div>
</div>
<p>We can reformat it into a dataframe for further analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dt_opt</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
<span class="n">dt_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_fit_time</th>
      <th>std_fit_time</th>
      <th>mean_score_time</th>
      <th>std_score_time</th>
      <th>param_criterion</th>
      <th>param_max_depth</th>
      <th>param_min_samples_leaf</th>
      <th>params</th>
      <th>split0_test_score</th>
      <th>split1_test_score</th>
      <th>split2_test_score</th>
      <th>split3_test_score</th>
      <th>split4_test_score</th>
      <th>mean_test_score</th>
      <th>std_test_score</th>
      <th>rank_test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000433</td>
      <td>0.000191</td>
      <td>0.000238</td>
      <td>0.000048</td>
      <td>gini</td>
      <td>2</td>
      <td>2</td>
      <td>{'criterion': 'gini', 'max_depth': 2, 'min_sam...</td>
      <td>0.916667</td>
      <td>0.875</td>
      <td>0.958333</td>
      <td>0.916667</td>
      <td>0.916667</td>
      <td>0.916667</td>
      <td>0.026352</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000321</td>
      <td>0.000010</td>
      <td>0.000209</td>
      <td>0.000015</td>
      <td>gini</td>
      <td>2</td>
      <td>4</td>
      <td>{'criterion': 'gini', 'max_depth': 2, 'min_sam...</td>
      <td>0.916667</td>
      <td>0.875</td>
      <td>0.958333</td>
      <td>0.916667</td>
      <td>0.916667</td>
      <td>0.916667</td>
      <td>0.026352</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-correction admonition">
<p class="admonition-title">Correction</p>
<p>The parameters in this function were in the wrong
order in this function in class</p>
</div>
<p>I changed the markers and the color of the error bars for readability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_score_time&#39;</span><span class="p">],</span>
     <span class="n">xerr</span><span class="o">=</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;std_fit_time&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;std_score_time&#39;</span><span class="p">],</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;fit time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;score time&#39;</span><span class="p">)</span>
<span class="c1"># save the limits so we can reuse them</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2021-11-15_18_0.png" src="../_images/2021-11-15_18_0.png" />
</div>
</div>
<p>The “points” are at the mean fit and score times. The lines are the “standard deviation” or how much we expect that number to vary, since means are an estimate.
Because the data shows an upward trend, this plot tells us that mostly, the models that are slower to fit are also slower to apply. This makes sense for decision trees, deeper trees take longer to learn and longer to traverse when predicting.
Because the error bars mostly overlap the other points, this tells us that mostly the variation in time is not a reliable difference. If we re-ran the GridSearch, we could get them in different orders.</p>
<p>To interpret the error bar plot, let’s look at a line plot of just the means, with the same limits so that it’s easier to compare to the plot above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">],</span>
            <span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_score_time&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;fit time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;score time&#39;</span><span class="p">)</span>
<span class="c1"># match the axis limits to above</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.00022338430927540292, 0.0006430288071796752)
</pre></div>
</div>
<img alt="../_images/2021-11-15_20_1.png" src="../_images/2021-11-15_20_1.png" />
</div>
</div>
<p>this plot shows the mean times, without the error bars.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_22_1.png" src="../_images/2021-11-15_22_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     0.916667
1     0.916667
2     0.908333
3     0.916667
4     0.908333
5     0.908333
6     0.908333
7     0.908333
8     0.916667
9     0.941667
10    0.941667
11    0.933333
12    0.908333
13    0.908333
14    0.916667
15    0.916667
16    0.908333
17    0.908333
18    0.925000
19    0.941667
20    0.941667
21    0.908333
22    0.908333
23    0.908333
24    0.916667
25    0.908333
26    0.908333
27    0.908333
28    0.916667
29    0.916667
30    0.908333
31    0.916667
32    0.916667
33    0.908333
34    0.908333
35    0.908333
36    0.925000
37    0.925000
38    0.916667
39    0.916667
40    0.916667
41    0.916667
42    0.916667
43    0.908333
44    0.916667
45    0.916667
46    0.925000
47    0.925000
48    0.916667
49    0.908333
50    0.908333
51    0.908333
52    0.908333
53    0.908333
Name: mean_test_score, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Now let’s compare with a different model, we’ll use the parameter optimized version for that model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svm_clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
<span class="n">svm_opt</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm_clf</span><span class="p">,</span><span class="n">param_grid</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [14],</span> in <span class="ni">&lt;cell line: 3&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">svm_clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">svm_opt</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm_clf</span><span class="p">,</span><span class="n">param_grid</span><span class="p">,)</span>

<span class="ne">NameError</span>: name &#39;GridSearchCV&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>The error above is because we didn’t import <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> directly today, we imported the whole <code class="docutils literal notranslate"><span class="pre">model_selection</span></code> module, so we have to use that in order to access the class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svm_clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
<span class="n">svm_opt</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm_clf</span><span class="p">,</span><span class="n">param_grid</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">model_selection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_opt</span><span class="o">.</span><span class="vm">__dict__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;scoring&#39;: None,
 &#39;estimator&#39;: DecisionTreeClassifier(),
 &#39;n_jobs&#39;: None,
 &#39;refit&#39;: True,
 &#39;cv&#39;: None,
 &#39;verbose&#39;: 0,
 &#39;pre_dispatch&#39;: &#39;2*n_jobs&#39;,
 &#39;error_score&#39;: nan,
 &#39;return_train_score&#39;: False,
 &#39;param_grid&#39;: {&#39;criterion&#39;: [&#39;gini&#39;, &#39;entropy&#39;],
  &#39;max_depth&#39;: [2, 3, 4],
  &#39;min_samples_leaf&#39;: [2, 4, 6, 8, 10, 12, 14, 16, 18]},
 &#39;multimetric_&#39;: False,
 &#39;best_index_&#39;: 9,
 &#39;best_score_&#39;: 0.9416666666666667,
 &#39;best_params_&#39;: {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
 &#39;best_estimator_&#39;: DecisionTreeClassifier(max_depth=3, min_samples_leaf=2),
 &#39;refit_time_&#39;: 0.00032830238342285156,
 &#39;scorer_&#39;: &lt;function sklearn.metrics._scorer._passthrough_scorer(estimator, *args, **kwargs)&gt;,
 &#39;cv_results_&#39;: {&#39;mean_fit_time&#39;: array([0.00043321, 0.00032129, 0.00031571, 0.00031662, 0.00031571,
         0.00031385, 0.00031204, 0.00030699, 0.00032072, 0.00034666,
         0.00032516, 0.00033627, 0.00032668, 0.0003222 , 0.00034633,
         0.00032625, 0.00031881, 0.00030398, 0.00032744, 0.00033131,
         0.0003274 , 0.0003212 , 0.00032439, 0.00031896, 0.00032763,
         0.00031948, 0.00030913, 0.00032988, 0.00032773, 0.00032196,
         0.00031948, 0.00031929, 0.00031438, 0.0003191 , 0.00032115,
         0.0003253 , 0.00034261, 0.0003449 , 0.00033703, 0.00033426,
         0.00033574, 0.00033708, 0.00033274, 0.00032563, 0.00031972,
         0.0003511 , 0.00033922, 0.00033498, 0.00033283, 0.00033641,
         0.00033674, 0.00033231, 0.00032601, 0.00032163]),
  &#39;std_fit_time&#39;: array([1.90747499e-04, 9.55175172e-06, 1.05750399e-05, 8.40776282e-06,
         2.03254600e-05, 6.73944845e-06, 7.18807304e-06, 5.22697052e-06,
         1.24803871e-05, 2.69714541e-05, 7.41692571e-06, 1.39686432e-05,
         1.19983069e-05, 9.68531277e-06, 3.13034061e-05, 1.26362747e-05,
         7.45819656e-06, 8.23286661e-06, 6.32344325e-06, 1.31977982e-05,
         6.12768217e-06, 6.47937307e-06, 9.24326416e-06, 9.32018449e-06,
         1.15925380e-05, 7.07263802e-06, 7.68077951e-06, 9.42353769e-06,
         1.39694571e-05, 1.03700845e-05, 9.99312355e-06, 4.52719153e-06,
         6.05714588e-06, 4.90609593e-06, 1.02236822e-05, 1.37793563e-05,
         1.23573525e-05, 1.96365456e-05, 9.93905262e-06, 6.32595976e-06,
         1.25140459e-05, 1.60428600e-05, 1.06566437e-05, 5.79587671e-06,
         7.19534474e-06, 1.43658620e-05, 6.05864722e-06, 1.04415362e-05,
         1.07864317e-05, 6.04098294e-06, 8.55467657e-06, 6.07551170e-06,
         1.20646397e-05, 1.12588110e-05]),
  &#39;mean_score_time&#39;: array([0.00023766, 0.00020909, 0.00020151, 0.00020409, 0.0002039 ,
         0.00020552, 0.00020628, 0.00021095, 0.00021043, 0.00020976,
         0.0002068 , 0.00021029, 0.00020118, 0.00020847, 0.0002069 ,
         0.00020428, 0.00019817, 0.00019794, 0.00020814, 0.00020318,
         0.00020308, 0.00020461, 0.00020857, 0.00020566, 0.00020742,
         0.00020399, 0.00020189, 0.00020952, 0.000208  , 0.00020266,
         0.00019803, 0.00020027, 0.00020504, 0.00020485, 0.00020766,
         0.00020018, 0.00021005, 0.00020094, 0.00020413, 0.00020571,
         0.00020471, 0.00020194, 0.00020394, 0.00020475, 0.00020633,
         0.00020652, 0.00019979, 0.00020523, 0.00020723, 0.00020113,
         0.00020351, 0.00020566, 0.00019794, 0.00020137]),
  &#39;std_score_time&#39;: array([4.80251960e-05, 1.49372617e-05, 6.20145011e-06, 6.04662608e-06,
         8.26374066e-06, 8.96022571e-06, 5.96789850e-06, 1.54361255e-05,
         1.50620171e-05, 1.03281211e-05, 6.20731367e-06, 1.03760029e-05,
         5.99450879e-06, 7.93127991e-06, 4.18259854e-06, 4.83560842e-06,
         2.73257232e-06, 7.03460068e-06, 7.60551530e-06, 4.93566769e-06,
         9.18626507e-06, 7.16748270e-06, 1.46571397e-05, 1.70915360e-05,
         1.01028730e-05, 4.49746175e-06, 7.19597671e-06, 1.14841555e-05,
         8.42613220e-06, 7.01939281e-06, 4.07298212e-06, 4.61572458e-06,
         8.06263814e-06, 9.04408127e-06, 1.44198900e-05, 5.82756657e-06,
         1.39795448e-05, 7.09574708e-06, 5.62869860e-06, 6.33565692e-06,
         3.99975147e-06, 4.60339294e-06, 6.33422124e-06, 9.50019509e-06,
         6.27833580e-06, 4.95864793e-06, 3.58738763e-06, 6.38214072e-06,
         5.36182129e-06, 2.58373588e-06, 5.22044143e-06, 1.15465505e-05,
         2.76565552e-06, 4.49746175e-06]),
  &#39;param_criterion&#39;: masked_array(data=[&#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                     &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                     &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                     &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;],
               mask=[False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False],
         fill_value=&#39;?&#39;,
              dtype=object),
  &#39;param_max_depth&#39;: masked_array(data=[2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                     4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                     3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4],
               mask=[False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False],
         fill_value=&#39;?&#39;,
              dtype=object),
  &#39;param_min_samples_leaf&#39;: masked_array(data=[2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4, 6, 8, 10, 12, 14,
                     16, 18, 2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4, 6, 8, 10,
                     12, 14, 16, 18, 2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4,
                     6, 8, 10, 12, 14, 16, 18],
               mask=[False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False],
         fill_value=&#39;?&#39;,
              dtype=object),
  &#39;params&#39;: [{&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 18}],
  &#39;split0_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
         0.95833333, 0.95833333, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
         0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.95833333, 0.95833333, 0.95833333, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.95833333, 0.95833333, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667]),
  &#39;split1_test_score&#39;: array([0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
         0.875     , 0.875     , 0.875     , 0.875     , 0.95833333,
         0.95833333, 0.95833333, 0.875     , 0.875     , 0.875     ,
         0.875     , 0.875     , 0.875     , 0.95833333, 0.95833333,
         0.95833333, 0.875     , 0.875     , 0.875     , 0.875     ,
         0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
         0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
         0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
         0.875     , 0.875     , 0.875     , 0.875     , 0.875     ,
         0.95833333, 0.95833333, 0.875     , 0.875     , 0.875     ,
         0.875     , 0.875     , 0.875     , 0.875     ]),
  &#39;split2_test_score&#39;: array([0.95833333, 0.95833333, 0.91666667, 0.95833333, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.95833333, 0.95833333,
         0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
         0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
         0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
         0.91666667, 0.91666667, 0.91666667, 0.95833333, 0.95833333,
         0.91666667, 0.95833333, 0.95833333, 0.91666667, 0.91666667,
         0.91666667, 0.95833333, 0.95833333, 0.91666667, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.91666667, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667]),
  &#39;split3_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667]),
  &#39;split4_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.83333333, 0.83333333, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667]),
  &#39;mean_test_score&#39;: array([0.91666667, 0.91666667, 0.90833333, 0.91666667, 0.90833333,
         0.90833333, 0.90833333, 0.90833333, 0.91666667, 0.94166667,
         0.94166667, 0.93333333, 0.90833333, 0.90833333, 0.91666667,
         0.91666667, 0.90833333, 0.90833333, 0.925     , 0.94166667,
         0.94166667, 0.90833333, 0.90833333, 0.90833333, 0.91666667,
         0.90833333, 0.90833333, 0.90833333, 0.91666667, 0.91666667,
         0.90833333, 0.91666667, 0.91666667, 0.90833333, 0.90833333,
         0.90833333, 0.925     , 0.925     , 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.90833333, 0.91666667,
         0.91666667, 0.925     , 0.925     , 0.91666667, 0.90833333,
         0.90833333, 0.90833333, 0.90833333, 0.90833333]),
  &#39;std_test_score&#39;: array([0.02635231, 0.02635231, 0.01666667, 0.02635231, 0.01666667,
         0.01666667, 0.01666667, 0.01666667, 0.02635231, 0.02041241,
         0.02041241, 0.02041241, 0.01666667, 0.01666667, 0.02635231,
         0.02635231, 0.01666667, 0.01666667, 0.01666667, 0.02041241,
         0.02041241, 0.01666667, 0.01666667, 0.01666667, 0.02635231,
         0.01666667, 0.01666667, 0.01666667, 0.02635231, 0.02635231,
         0.01666667, 0.02635231, 0.02635231, 0.01666667, 0.01666667,
         0.01666667, 0.03118048, 0.03118048, 0.02635231, 0.02635231,
         0.02635231, 0.02635231, 0.02635231, 0.01666667, 0.02635231,
         0.04564355, 0.04859127, 0.03118048, 0.02635231, 0.01666667,
         0.01666667, 0.01666667, 0.01666667, 0.01666667]),
  &#39;rank_test_score&#39;: array([11, 11, 30, 11, 30, 30, 30, 30, 11,  1,  1,  5, 30, 30, 11, 11, 30,
         30,  6,  1,  1, 30, 30, 30, 11, 30, 30, 30, 11, 11, 30, 11, 11, 30,
         30, 30,  6,  6, 11, 11, 11, 11, 11, 30, 11, 11,  6,  6, 11, 30, 30,
         30, 30, 30], dtype=int32)},
 &#39;n_splits_&#39;: 5}
</pre></div>
</div>
</div>
</div>
<p>This doesn’t have attributes yet, even though they are the same type, because we have not fit it tot data yet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">svm_opt</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">dt_opt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(sklearn.model_selection._search.GridSearchCV,
 sklearn.model_selection._search.GridSearchCV)
</pre></div>
</div>
</div>
</div>
<p>Now we can fit the model to the training data of this second model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit the model and  put the CV results in a dataframe</span>
<span class="n">svm_opt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris_X_train</span><span class="p">,</span><span class="n">iris_y_train</span><span class="p">)</span>
<span class="n">sv_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">svm_opt</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_fit_time</th>
      <th>std_fit_time</th>
      <th>mean_score_time</th>
      <th>std_score_time</th>
      <th>param_C</th>
      <th>param_kernel</th>
      <th>params</th>
      <th>split0_test_score</th>
      <th>split1_test_score</th>
      <th>split2_test_score</th>
      <th>split3_test_score</th>
      <th>split4_test_score</th>
      <th>split5_test_score</th>
      <th>split6_test_score</th>
      <th>split7_test_score</th>
      <th>split8_test_score</th>
      <th>split9_test_score</th>
      <th>mean_test_score</th>
      <th>std_test_score</th>
      <th>rank_test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000471</td>
      <td>0.000056</td>
      <td>0.000252</td>
      <td>0.000019</td>
      <td>0.5</td>
      <td>linear</td>
      <td>{'C': 0.5, 'kernel': 'linear'}</td>
      <td>1.0</td>
      <td>0.916667</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.991667</td>
      <td>0.025000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000551</td>
      <td>0.000013</td>
      <td>0.000271</td>
      <td>0.000007</td>
      <td>0.5</td>
      <td>rbf</td>
      <td>{'C': 0.5, 'kernel': 'rbf'}</td>
      <td>1.0</td>
      <td>0.833333</td>
      <td>1.0</td>
      <td>0.916667</td>
      <td>0.916667</td>
      <td>1.0</td>
      <td>0.916667</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.958333</td>
      <td>0.055902</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">],</span><span class="n">xerr</span><span class="o">=</span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;std_fit_time&#39;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;mean_score_time&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;std_score_time&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ErrorbarContainer object of 3 artists&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_35_1.png" src="../_images/2021-11-15_35_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;mean_fit_time&#39;, &#39;std_fit_time&#39;, &#39;mean_score_time&#39;, &#39;std_score_time&#39;,
       &#39;param_C&#39;, &#39;param_kernel&#39;, &#39;params&#39;, &#39;split0_test_score&#39;,
       &#39;split1_test_score&#39;, &#39;split2_test_score&#39;, &#39;split3_test_score&#39;,
       &#39;split4_test_score&#39;, &#39;split5_test_score&#39;, &#39;split6_test_score&#39;,
       &#39;split7_test_score&#39;, &#39;split8_test_score&#39;, &#39;split9_test_score&#39;,
       &#39;mean_test_score&#39;, &#39;std_test_score&#39;, &#39;rank_test_score&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can see if the models that take longer to fit or score perform better.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svm_time</span> <span class="o">=</span> <span class="n">sv_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;param_C&#39;</span><span class="p">,</span> <span class="s1">&#39;param_kernel&#39;</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">,],</span>
                      <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">,</span> <span class="s1">&#39;std_fit_time&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_score_time&#39;</span><span class="p">,</span> <span class="s1">&#39;std_score_time&#39;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">,</span>
          <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;param_kernel&#39;</span><span class="p">,</span><span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7fb76a9111f0&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_38_1.png" src="../_images/2021-11-15_38_1.png" />
</div>
</div>
<p>This looks like mostly no.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mean_score_time&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">,</span>
          <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;param_kernel&#39;</span><span class="p">,</span><span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7fb76a9d08b0&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_40_1.png" src="../_images/2021-11-15_40_1.png" />
</div>
</div>
<p>Again, for score time, the slower models don’t appear to be better.  Remember though the time differences weren’t that different.</p>
<div class="admonition-try-it-yourself admonition">
<p class="admonition-title">Try it yourself</p>
<p>Try this same analysis for the decision tree, does it matter there?</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv_df_scores</span> <span class="o">=</span> <span class="n">sv_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;param_C&#39;</span><span class="p">,</span> <span class="s1">&#39;param_kernel&#39;</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">,],</span>
                    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;split0_test_score&#39;</span><span class="p">,</span>
       <span class="s1">&#39;split1_test_score&#39;</span><span class="p">,</span> <span class="s1">&#39;split2_test_score&#39;</span><span class="p">,</span> <span class="s1">&#39;split3_test_score&#39;</span><span class="p">,</span>
       <span class="s1">&#39;split4_test_score&#39;</span><span class="p">],</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">)</span>
<span class="n">sv_df_scores</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>param_C</th>
      <th>param_kernel</th>
      <th>params</th>
      <th>variable</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.5</td>
      <td>linear</td>
      <td>{'C': 0.5, 'kernel': 'linear'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5</td>
      <td>rbf</td>
      <td>{'C': 0.5, 'kernel': 'rbf'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.75</td>
      <td>linear</td>
      <td>{'C': 0.75, 'kernel': 'linear'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.75</td>
      <td>rbf</td>
      <td>{'C': 0.75, 'kernel': 'rbf'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>linear</td>
      <td>{'C': 1, 'kernel': 'linear'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df_scores</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;param_C&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="s1">&#39;param_kernel&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7fb769fc5f10&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_43_1.png" src="../_images/2021-11-15_43_1.png" />
</div>
</div>
<div class="admonition-try-it-yourself admonition">
<p class="admonition-title">Try it yourself</p>
<p>Try interpretting the plot above, what does it say? what can you conclude from it.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_45_1.png" src="../_images/2021-11-15_45_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_46_1.png" src="../_images/2021-11-15_46_1.png" />
</div>
</div>
<p>From these last two plots we see that the SVM performance is more sensitive to its parameters, where for the parameters tested, the decision tree is not impacted.</p>
<p>What can we say based on this?  We’ll pick up from here on Wednesday.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="2021-11-12.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">26. </span>SVM and Parameter Optimizing</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2021-11-17.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">28. </span>Model Selection</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Professor Sarah M Brown<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>