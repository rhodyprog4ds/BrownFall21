
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>32. Model Comparison &#8212; Programming for Data Science at URI Fall 2021</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/course_admonitions.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="33. Model Selection" href="2021-11-17.html" />
    <link rel="prev" title="31. SVM and Parameter Optimizing" href="2021-11-12.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/310_2021.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Programming for Data Science at URI Fall 2021</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About this Book
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Syllabus
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/about.html">
   Basic Facts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/tools.html">
   Tools and Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/achievements.html">
   Data Science Achievements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/grading.html">
   Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/policies.html">
   Grading Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/uri_resources.html">
   Support
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/uri_statements.html">
   General URI Policies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus/communication.html">
   Course Communications
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Notes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-08.html">
   1. Welcome to Programming to Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-10.html">
   2. Jupyter Notebook Tour &amp; Python Review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-13.html">
   3. Getting help, object inspection, loading data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-15.html">
   4. Pandas DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-17.html">
   5. More Loading Data, Indexing, and Iterables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-20.html">
   6. Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-22.html">
   7. Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-24.html">
   8. Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-27.html">
   9. Reshaping Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-29.html">
   10. More Reshaping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-01.html">
   11. Missing Data and Inconsistent coding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-04.html">
   12. Building Datasets From multiple Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-06.html">
   13. Reviewing Merges &amp; Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-08.html">
   14. Web Scraping
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-13.html">
   15. Intro to Machine learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-15.html">
   16. Interpetting and Evaluating Naive Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-18.html">
   17. Making Predictions in Generative Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-20.html">
   18. Midsemester feedback and Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-22.html">
   19. Decision Tree Setting and more Evaluation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-25.html">
   25. Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-10-29.html">
   26. Interpretting Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-01.html">
   27. Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-03.html">
   28. Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-05.html">
   29. Evaluating Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-08.html">
   30. ML Task Review and Cross Validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-12.html">
   31. SVM and Parameter Optimizing
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   32. Model Comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-17.html">
   33. Model Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-19.html">
   34. Learning Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-22.html">
   35. Intro to NLP- representing text data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-29.html">
   36. More NLP &amp; Solving problems with ML
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-01.html">
   37. Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-03.html">
   38. Predicting with Neural Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-06.html">
   39. Review, IDEA, &amp; Preparing for Deep Learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/01-python-syllabus.html">
   1. Portfolio Setup, Data Science, and Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/02-python-access.html">
   2. Practicing Python and Accessing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/03-eda.html">
   3. Assignment 3: Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/04-prepare.html">
   4. Assignment 4:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/05-construct.html">
   5. Assignment 5: Constructing Datasets and Using Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/06-classification.html">
   6. Assignment 6: Understanding Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/07-decision-tree.html">
   7. Assignment 7: Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/08-regression.html">
   8. Assignment 8: Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/09-clustering.html">
   9. Assignment 9: Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/10-optimize.html">
   10. Assignment 10: Tuning Model Parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/11-compare.html">
   11. Assignment 11: Model Comparison
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../assignments/12-fake-news.html">
   12. Assignment 12: Fake News
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Portfolio
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/index.html">
   Portfolio Dates and Key Facts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/intro_reflection.html">
   Submission Introductions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/formatting.html">
   Formatting Tips
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/check1ideas.html">
   Portfolio Check 1 Ideas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../portfolio/check2ideas.html">
   Check 2 Ideas
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  FAQ
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/index.html">
   FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/syllabus.html">
   Syllabus and Grading FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/github.html">
   Git and GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../faq/debugging.html">
   Code Errors
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/python.html">
   References on Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/cheatsheet.html">
   Cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/datasets.html">
   Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/tips.html">
   General Tips and Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/learning.html">
   How to Study in this class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/gettinghelp.html">
   Getting Help with Programming
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/terminal.html">
   Terminals and Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../resources/organization.html">
   Getting Organized for class
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://rhodyprog4ds.github.io/BrownFall20/letters/">
   Advice from FA2020 Students
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/notes/2021-11-15.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notes/2021-11-15.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/rhodyprog4ds/BrownFall21/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/rhodyprog4ds/BrownFall21//issues/new?title=Issue%20on%20page%20%2Fnotes/2021-11-15.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/rhodyprog4ds/BrownFall21/edit/main/notes/2021-11-15.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/rhodyprog4ds/BrownFall21/main?urlpath=tree/notes/2021-11-15.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="model-comparison">
<h1><span class="section-number">32. </span>Model Comparison<a class="headerlink" href="#model-comparison" title="Permalink to this headline">¶</a></h1>
<p>To compare models, we will first optimize the parameters of two diffrent models and look at how the different parameters settings impact the model comparison.  Later, we’ll see how to compare across models of different classes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">cluster</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="c1"># import the whole model selection module</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s1">&#39;colorblind&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll use the iris data again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_X</span><span class="p">,</span> <span class="n">iris_y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Remember, we need to split the data into training and test.  The cross validation step will hep us optimize the parameters, but we don’t want <em>data leakage</em> where the model has seen the test data multiple times. So, we split the data here for train and test annd the cross validation splits the training data into train and “test” again, but this test is better termed validation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_X_train</span><span class="p">,</span> <span class="n">iris_X_test</span><span class="p">,</span> <span class="n">iris_y_train</span><span class="p">,</span> <span class="n">iris_y_test</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">iris_X</span><span class="p">,</span><span class="n">iris_y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we can make the object, the parameter grid dictionary and the Grid Search object.  We split these into separate cells, so that we can use the built in help to see more detail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params_dt</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;criterion&#39;</span><span class="p">:[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span><span class="s1">&#39;entropy&#39;</span><span class="p">],</span>
             <span class="s1">&#39;max_depth&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
       <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">))}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_opt</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="n">params_dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we fit the Grid search using the training data, and remember this actually resets the parameters and then cross validates multiple times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_opt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris_X_train</span><span class="p">,</span><span class="n">iris_y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GridSearchCV(estimator=DecisionTreeClassifier(),
             param_grid={&#39;criterion&#39;: [&#39;gini&#39;, &#39;entropy&#39;],
                         &#39;max_depth&#39;: [2, 3, 4],
                         &#39;min_samples_leaf&#39;: [2, 4, 6, 8, 10, 12, 14, 16, 18]})
</pre></div>
</div>
</div>
</div>
<p>adn look at the results</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_opt</span><span class="o">.</span><span class="n">cv_results_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;mean_fit_time&#39;: array([0.00064125, 0.00051675, 0.00052032, 0.00058012, 0.00051913,
        0.00054884, 0.00052738, 0.00053992, 0.00075784, 0.00054855,
        0.00056696, 0.00063148, 0.00056534, 0.00051103, 0.0005404 ,
        0.00052962, 0.00062652, 0.00054846, 0.00053654, 0.00055752,
        0.00051851, 0.00056953, 0.00055251, 0.00050807, 0.00053697,
        0.00054011, 0.00054531, 0.00057435, 0.00058947, 0.00052481,
        0.00052052, 0.00053272, 0.00062065, 0.00055742, 0.00053725,
        0.0005806 , 0.00056477, 0.00054326, 0.00055861, 0.00053868,
        0.00054317, 0.00053992, 0.00053315, 0.0005538 , 0.00052485,
        0.00054722, 0.00051427, 0.00056548, 0.00056939, 0.00053253,
        0.00058737, 0.00053663, 0.00057168, 0.00054445]),
 &#39;std_fit_time&#39;: array([2.11762604e-04, 3.45851934e-05, 4.54960126e-05, 8.21654765e-05,
        2.62237028e-05, 6.51012834e-05, 2.96203781e-05, 2.85981471e-05,
        4.17530596e-04, 3.35265695e-05, 4.11267557e-05, 1.88293726e-04,
        3.34855139e-05, 1.50597525e-05, 2.72518172e-05, 3.08954419e-05,
        1.34085931e-04, 7.58005520e-05, 4.34182686e-05, 7.75280032e-05,
        3.47144001e-05, 5.51998277e-05, 6.20410039e-05, 2.29858263e-05,
        4.80765375e-05, 5.31474748e-05, 3.52380402e-05, 4.44835658e-05,
        9.17760539e-05, 1.91623288e-05, 4.25702098e-05, 3.87054334e-05,
        2.07398753e-04, 4.62490257e-05, 3.36157007e-05, 9.65204160e-05,
        4.25533819e-05, 3.41388765e-05, 4.69850375e-05, 3.32853513e-05,
        4.04304487e-05, 4.73078217e-05, 2.30082700e-05, 3.67840232e-05,
        2.18184135e-05, 3.35130029e-05, 1.62761503e-05, 7.90946800e-05,
        7.13819652e-05, 2.90297898e-05, 4.76242171e-05, 4.12218484e-05,
        8.64130239e-05, 4.96351981e-05]),
 &#39;mean_score_time&#39;: array([0.0003655 , 0.00029421, 0.00045805, 0.00030508, 0.00028868,
        0.00030828, 0.00030136, 0.00030751, 0.00033202, 0.00031114,
        0.00030994, 0.00030413, 0.0003015 , 0.00031333, 0.00030746,
        0.00029259, 0.00031633, 0.0003253 , 0.00031266, 0.00030298,
        0.00028744, 0.00033164, 0.00030675, 0.00029349, 0.00051842,
        0.00031118, 0.00030599, 0.00040803, 0.00031424, 0.00031886,
        0.00030537, 0.00029216, 0.00029473, 0.00031199, 0.00030661,
        0.00047135, 0.0003294 , 0.00029707, 0.00032668, 0.00080857,
        0.00032372, 0.00031199, 0.000319  , 0.00030379, 0.00032039,
        0.00030022, 0.00028925, 0.00028629, 0.00036225, 0.00028176,
        0.00033665, 0.00030622, 0.00031571, 0.00029354]),
 &#39;std_score_time&#39;: array([4.94999691e-05, 2.42583142e-05, 3.59632229e-04, 2.94269188e-05,
        1.19413201e-05, 2.03000505e-05, 2.45962017e-05, 1.36031538e-05,
        2.31590731e-05, 2.19070221e-05, 2.25584801e-05, 1.44014295e-05,
        2.98237152e-05, 4.58427286e-05, 1.74990792e-05, 1.24228664e-05,
        2.60679508e-05, 3.47282175e-05, 1.38328808e-05, 3.01379946e-05,
        1.34520487e-05, 5.97937445e-05, 3.63391213e-05, 1.42014242e-05,
        4.32445420e-04, 2.40381741e-05, 1.74841303e-05, 1.93167351e-04,
        2.80390791e-05, 3.30680983e-05, 3.14601965e-05, 1.80642632e-05,
        2.08930868e-05, 2.07818960e-05, 3.55264484e-05, 2.56884928e-04,
        4.77203229e-05, 1.16117436e-05, 7.21802001e-05, 1.01429383e-03,
        3.54124714e-05, 3.28366007e-05, 7.32400765e-05, 2.14435743e-05,
        4.78858003e-05, 2.93258341e-05, 1.35989744e-05, 8.63773106e-06,
        5.99569589e-05, 3.61390978e-06, 4.23191299e-05, 3.53620971e-05,
        5.26242033e-05, 1.47398997e-05]),
 &#39;param_criterion&#39;: masked_array(data=[&#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                    &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                    &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                    &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                    &#39;entropy&#39;, &#39;entropy&#39;],
              mask=[False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_max_depth&#39;: masked_array(data=[2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                    4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                    3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4],
              mask=[False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_min_samples_leaf&#39;: masked_array(data=[2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4, 6, 8, 10, 12, 14,
                    16, 18, 2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4, 6, 8, 10,
                    12, 14, 16, 18, 2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4,
                    6, 8, 10, 12, 14, 16, 18],
              mask=[False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;params&#39;: [{&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 18},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 4},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 6},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 8},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 10},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 12},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 14},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 16},
  {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 18}],
 &#39;split0_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667]),
 &#39;split1_test_score&#39;: array([0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.95833333]),
 &#39;split2_test_score&#39;: array([0.95833333, 0.95833333, 0.91666667, 0.91666667, 0.95833333,
        0.91666667, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.95833333, 0.95833333, 0.91666667, 0.95833333,
        0.91666667, 0.91666667, 0.91666667, 1.        , 0.91666667,
        0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.91666667, 0.95833333, 0.95833333, 0.95833333, 0.91666667,
        1.        , 0.95833333, 0.95833333, 0.91666667, 0.91666667,
        0.95833333, 0.95833333, 0.95833333, 0.95833333]),
 &#39;split3_test_score&#39;: array([1.        , 0.95833333, 0.95833333, 0.95833333, 0.95833333,
        0.95833333, 1.        , 0.95833333, 1.        , 1.        ,
        1.        , 1.        , 0.95833333, 1.        , 0.95833333,
        1.        , 1.        , 0.95833333, 1.        , 1.        ,
        1.        , 1.        , 0.95833333, 0.95833333, 0.95833333,
        1.        , 1.        , 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 0.95833333, 0.95833333,
        0.95833333, 1.        , 1.        , 0.95833333, 1.        ,
        1.        , 0.95833333, 1.        , 1.        , 1.        ,
        1.        , 1.        , 1.        , 0.95833333, 0.95833333,
        0.95833333, 1.        , 0.95833333, 1.        ]),
 &#39;split4_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.95833333, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.95833333, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
        0.91666667, 0.91666667, 0.91666667, 0.91666667]),
 &#39;mean_test_score&#39;: array([0.95      , 0.94166667, 0.93333333, 0.93333333, 0.94166667,
        0.93333333, 0.95      , 0.94166667, 0.95      , 0.95833333,
        0.95      , 0.95      , 0.94166667, 0.94166667, 0.94166667,
        0.94166667, 0.94166667, 0.93333333, 0.96666667, 0.94166667,
        0.95      , 0.94166667, 0.93333333, 0.93333333, 0.93333333,
        0.95      , 0.95      , 0.95      , 0.95      , 0.95      ,
        0.95      , 0.94166667, 0.94166667, 0.93333333, 0.93333333,
        0.93333333, 0.95833333, 0.95      , 0.94166667, 0.95      ,
        0.94166667, 0.94166667, 0.95      , 0.95      , 0.94166667,
        0.96666667, 0.95      , 0.95      , 0.93333333, 0.93333333,
        0.94166667, 0.95      , 0.94166667, 0.95      ]),
 &#39;std_test_score&#39;: array([0.03118048, 0.02041241, 0.02041241, 0.02041241, 0.02041241,
        0.02041241, 0.03118048, 0.02041241, 0.03118048, 0.02635231,
        0.03118048, 0.03118048, 0.02041241, 0.03333333, 0.02041241,
        0.03333333, 0.03333333, 0.02041241, 0.03118048, 0.03333333,
        0.03118048, 0.03333333, 0.02041241, 0.02041241, 0.02041241,
        0.03118048, 0.03118048, 0.03118048, 0.03118048, 0.03118048,
        0.03118048, 0.03333333, 0.03333333, 0.02041241, 0.02041241,
        0.02041241, 0.02635231, 0.03118048, 0.02041241, 0.03118048,
        0.03333333, 0.02041241, 0.03118048, 0.03118048, 0.03333333,
        0.03118048, 0.03118048, 0.03118048, 0.02041241, 0.02041241,
        0.02041241, 0.03118048, 0.02041241, 0.03118048]),
 &#39;rank_test_score&#39;: array([ 5, 25, 43, 43, 25, 43,  5, 25,  5,  3,  5,  5, 25, 34, 25, 34, 34,
        43,  1, 34,  5, 34, 43, 43, 43,  5,  5,  5,  5,  5,  5, 34, 34, 43,
        43, 43,  3,  5, 25,  5, 34, 25,  5,  5, 34,  1,  5,  5, 43, 43, 25,
         5, 25,  5], dtype=int32)}
</pre></div>
</div>
</div>
</div>
<p>We can reformat it into a dataframe for further analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dt_opt</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
<span class="n">dt_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_fit_time</th>
      <th>std_fit_time</th>
      <th>mean_score_time</th>
      <th>std_score_time</th>
      <th>param_criterion</th>
      <th>param_max_depth</th>
      <th>param_min_samples_leaf</th>
      <th>params</th>
      <th>split0_test_score</th>
      <th>split1_test_score</th>
      <th>split2_test_score</th>
      <th>split3_test_score</th>
      <th>split4_test_score</th>
      <th>mean_test_score</th>
      <th>std_test_score</th>
      <th>rank_test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000641</td>
      <td>0.000212</td>
      <td>0.000365</td>
      <td>0.000049</td>
      <td>gini</td>
      <td>2</td>
      <td>2</td>
      <td>{'criterion': 'gini', 'max_depth': 2, 'min_sam...</td>
      <td>0.916667</td>
      <td>0.958333</td>
      <td>0.958333</td>
      <td>1.000000</td>
      <td>0.916667</td>
      <td>0.950000</td>
      <td>0.031180</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000517</td>
      <td>0.000035</td>
      <td>0.000294</td>
      <td>0.000024</td>
      <td>gini</td>
      <td>2</td>
      <td>4</td>
      <td>{'criterion': 'gini', 'max_depth': 2, 'min_sam...</td>
      <td>0.916667</td>
      <td>0.958333</td>
      <td>0.958333</td>
      <td>0.958333</td>
      <td>0.916667</td>
      <td>0.941667</td>
      <td>0.020412</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-correction admonition">
<p class="admonition-title">Correction</p>
<p>The parameters in this function were in the wrong
order in this function in class</p>
</div>
<p>I changed the markers and the color of the error bars for readability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_score_time&#39;</span><span class="p">],</span>
     <span class="n">xerr</span><span class="o">=</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;std_fit_time&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;std_score_time&#39;</span><span class="p">],</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;fit time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;score time&#39;</span><span class="p">)</span>
<span class="c1"># save the limits so we can reuse them</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2021-11-15_18_0.png" src="../_images/2021-11-15_18_0.png" />
</div>
</div>
<p>The “points” are at the mean fit and score times. The lines are the “standard deviation” or how much we expect that number to vary, since means are an estimate.
Because the data shows an upward trend, this plot tells us that mostly, the models that are slower to fit are also slower to apply. This makes sense for decision trees, deeper trees take longer to learn and longer to traverse when predicting.
Because the error bars mostly overlap the other points, this tells us that mostly the variation in time is not a reliable difference. If we re-ran the GridSearch, we could get them in different orders.</p>
<p>To interpret the error bar plot, let’s look at a line plot of just the means, with the same limits so that it’s easier to compare to the plot above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">],</span>
            <span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_score_time&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;fit time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;score time&#39;</span><span class="p">)</span>
<span class="c1"># match the axis limits to above</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.00029855363950995314, 0.0012171209515544998)
</pre></div>
</div>
<img alt="../_images/2021-11-15_20_1.png" src="../_images/2021-11-15_20_1.png" />
</div>
</div>
<p>this plot shows the mean times, without the error bars.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_22_1.png" src="../_images/2021-11-15_22_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     0.950000
1     0.941667
2     0.933333
3     0.933333
4     0.941667
5     0.933333
6     0.950000
7     0.941667
8     0.950000
9     0.958333
10    0.950000
11    0.950000
12    0.941667
13    0.941667
14    0.941667
15    0.941667
16    0.941667
17    0.933333
18    0.966667
19    0.941667
20    0.950000
21    0.941667
22    0.933333
23    0.933333
24    0.933333
25    0.950000
26    0.950000
27    0.950000
28    0.950000
29    0.950000
30    0.950000
31    0.941667
32    0.941667
33    0.933333
34    0.933333
35    0.933333
36    0.958333
37    0.950000
38    0.941667
39    0.950000
40    0.941667
41    0.941667
42    0.950000
43    0.950000
44    0.941667
45    0.966667
46    0.950000
47    0.950000
48    0.933333
49    0.933333
50    0.941667
51    0.950000
52    0.941667
53    0.950000
Name: mean_test_score, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Now let’s compare with a different model, we’ll use the parameter optimized version for that model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svm_clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
<span class="n">svm_opt</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm_clf</span><span class="p">,</span><span class="n">param_grid</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_2325</span><span class="o">/</span><span class="mf">492760704.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">svm_clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">svm_opt</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm_clf</span><span class="p">,</span><span class="n">param_grid</span><span class="p">,)</span>

<span class="ne">NameError</span>: name &#39;GridSearchCV&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>The error above is because we didn’t import <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> directly today, we imported the whole <code class="docutils literal notranslate"><span class="pre">model_selection</span></code> module, so we have to use that in order to access the class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svm_clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
<span class="n">svm_opt</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svm_clf</span><span class="p">,</span><span class="n">param_grid</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">model_selection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>module
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_opt</span><span class="o">.</span><span class="vm">__dict__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;scoring&#39;: None,
 &#39;estimator&#39;: DecisionTreeClassifier(),
 &#39;n_jobs&#39;: None,
 &#39;refit&#39;: True,
 &#39;cv&#39;: None,
 &#39;verbose&#39;: 0,
 &#39;pre_dispatch&#39;: &#39;2*n_jobs&#39;,
 &#39;error_score&#39;: nan,
 &#39;return_train_score&#39;: False,
 &#39;param_grid&#39;: {&#39;criterion&#39;: [&#39;gini&#39;, &#39;entropy&#39;],
  &#39;max_depth&#39;: [2, 3, 4],
  &#39;min_samples_leaf&#39;: [2, 4, 6, 8, 10, 12, 14, 16, 18]},
 &#39;multimetric_&#39;: False,
 &#39;best_index_&#39;: 18,
 &#39;best_score_&#39;: 0.9666666666666666,
 &#39;best_params_&#39;: {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
 &#39;best_estimator_&#39;: DecisionTreeClassifier(max_depth=4, min_samples_leaf=2),
 &#39;refit_time_&#39;: 0.00038743019104003906,
 &#39;scorer_&#39;: &lt;function sklearn.metrics._scorer._passthrough_scorer(estimator, *args, **kwargs)&gt;,
 &#39;cv_results_&#39;: {&#39;mean_fit_time&#39;: array([0.00064125, 0.00051675, 0.00052032, 0.00058012, 0.00051913,
         0.00054884, 0.00052738, 0.00053992, 0.00075784, 0.00054855,
         0.00056696, 0.00063148, 0.00056534, 0.00051103, 0.0005404 ,
         0.00052962, 0.00062652, 0.00054846, 0.00053654, 0.00055752,
         0.00051851, 0.00056953, 0.00055251, 0.00050807, 0.00053697,
         0.00054011, 0.00054531, 0.00057435, 0.00058947, 0.00052481,
         0.00052052, 0.00053272, 0.00062065, 0.00055742, 0.00053725,
         0.0005806 , 0.00056477, 0.00054326, 0.00055861, 0.00053868,
         0.00054317, 0.00053992, 0.00053315, 0.0005538 , 0.00052485,
         0.00054722, 0.00051427, 0.00056548, 0.00056939, 0.00053253,
         0.00058737, 0.00053663, 0.00057168, 0.00054445]),
  &#39;std_fit_time&#39;: array([2.11762604e-04, 3.45851934e-05, 4.54960126e-05, 8.21654765e-05,
         2.62237028e-05, 6.51012834e-05, 2.96203781e-05, 2.85981471e-05,
         4.17530596e-04, 3.35265695e-05, 4.11267557e-05, 1.88293726e-04,
         3.34855139e-05, 1.50597525e-05, 2.72518172e-05, 3.08954419e-05,
         1.34085931e-04, 7.58005520e-05, 4.34182686e-05, 7.75280032e-05,
         3.47144001e-05, 5.51998277e-05, 6.20410039e-05, 2.29858263e-05,
         4.80765375e-05, 5.31474748e-05, 3.52380402e-05, 4.44835658e-05,
         9.17760539e-05, 1.91623288e-05, 4.25702098e-05, 3.87054334e-05,
         2.07398753e-04, 4.62490257e-05, 3.36157007e-05, 9.65204160e-05,
         4.25533819e-05, 3.41388765e-05, 4.69850375e-05, 3.32853513e-05,
         4.04304487e-05, 4.73078217e-05, 2.30082700e-05, 3.67840232e-05,
         2.18184135e-05, 3.35130029e-05, 1.62761503e-05, 7.90946800e-05,
         7.13819652e-05, 2.90297898e-05, 4.76242171e-05, 4.12218484e-05,
         8.64130239e-05, 4.96351981e-05]),
  &#39;mean_score_time&#39;: array([0.0003655 , 0.00029421, 0.00045805, 0.00030508, 0.00028868,
         0.00030828, 0.00030136, 0.00030751, 0.00033202, 0.00031114,
         0.00030994, 0.00030413, 0.0003015 , 0.00031333, 0.00030746,
         0.00029259, 0.00031633, 0.0003253 , 0.00031266, 0.00030298,
         0.00028744, 0.00033164, 0.00030675, 0.00029349, 0.00051842,
         0.00031118, 0.00030599, 0.00040803, 0.00031424, 0.00031886,
         0.00030537, 0.00029216, 0.00029473, 0.00031199, 0.00030661,
         0.00047135, 0.0003294 , 0.00029707, 0.00032668, 0.00080857,
         0.00032372, 0.00031199, 0.000319  , 0.00030379, 0.00032039,
         0.00030022, 0.00028925, 0.00028629, 0.00036225, 0.00028176,
         0.00033665, 0.00030622, 0.00031571, 0.00029354]),
  &#39;std_score_time&#39;: array([4.94999691e-05, 2.42583142e-05, 3.59632229e-04, 2.94269188e-05,
         1.19413201e-05, 2.03000505e-05, 2.45962017e-05, 1.36031538e-05,
         2.31590731e-05, 2.19070221e-05, 2.25584801e-05, 1.44014295e-05,
         2.98237152e-05, 4.58427286e-05, 1.74990792e-05, 1.24228664e-05,
         2.60679508e-05, 3.47282175e-05, 1.38328808e-05, 3.01379946e-05,
         1.34520487e-05, 5.97937445e-05, 3.63391213e-05, 1.42014242e-05,
         4.32445420e-04, 2.40381741e-05, 1.74841303e-05, 1.93167351e-04,
         2.80390791e-05, 3.30680983e-05, 3.14601965e-05, 1.80642632e-05,
         2.08930868e-05, 2.07818960e-05, 3.55264484e-05, 2.56884928e-04,
         4.77203229e-05, 1.16117436e-05, 7.21802001e-05, 1.01429383e-03,
         3.54124714e-05, 3.28366007e-05, 7.32400765e-05, 2.14435743e-05,
         4.78858003e-05, 2.93258341e-05, 1.35989744e-05, 8.63773106e-06,
         5.99569589e-05, 3.61390978e-06, 4.23191299e-05, 3.53620971e-05,
         5.26242033e-05, 1.47398997e-05]),
  &#39;param_criterion&#39;: masked_array(data=[&#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                     &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                     &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                     &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;, &#39;gini&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;, &#39;entropy&#39;,
                     &#39;entropy&#39;, &#39;entropy&#39;],
               mask=[False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False],
         fill_value=&#39;?&#39;,
              dtype=object),
  &#39;param_max_depth&#39;: masked_array(data=[2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3,
                     4, 4, 4, 4, 4, 4, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2,
                     3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4],
               mask=[False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False],
         fill_value=&#39;?&#39;,
              dtype=object),
  &#39;param_min_samples_leaf&#39;: masked_array(data=[2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4, 6, 8, 10, 12, 14,
                     16, 18, 2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4, 6, 8, 10,
                     12, 14, 16, 18, 2, 4, 6, 8, 10, 12, 14, 16, 18, 2, 4,
                     6, 8, 10, 12, 14, 16, 18],
               mask=[False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False, False, False,
                     False, False, False, False, False, False],
         fill_value=&#39;?&#39;,
              dtype=object),
  &#39;params&#39;: [{&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;gini&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 2, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 3, &#39;min_samples_leaf&#39;: 18},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 2},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 4},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 6},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 8},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 10},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 12},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 14},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 16},
   {&#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: 4, &#39;min_samples_leaf&#39;: 18}],
  &#39;split0_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667]),
  &#39;split1_test_score&#39;: array([0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.95833333]),
  &#39;split2_test_score&#39;: array([0.95833333, 0.95833333, 0.91666667, 0.91666667, 0.95833333,
         0.91666667, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.95833333, 0.95833333, 0.91666667, 0.95833333,
         0.91666667, 0.91666667, 0.91666667, 1.        , 0.91666667,
         0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.95833333, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.91666667, 0.95833333, 0.95833333, 0.95833333, 0.91666667,
         1.        , 0.95833333, 0.95833333, 0.91666667, 0.91666667,
         0.95833333, 0.95833333, 0.95833333, 0.95833333]),
  &#39;split3_test_score&#39;: array([1.        , 0.95833333, 0.95833333, 0.95833333, 0.95833333,
         0.95833333, 1.        , 0.95833333, 1.        , 1.        ,
         1.        , 1.        , 0.95833333, 1.        , 0.95833333,
         1.        , 1.        , 0.95833333, 1.        , 1.        ,
         1.        , 1.        , 0.95833333, 0.95833333, 0.95833333,
         1.        , 1.        , 1.        , 1.        , 1.        ,
         1.        , 1.        , 1.        , 0.95833333, 0.95833333,
         0.95833333, 1.        , 1.        , 0.95833333, 1.        ,
         1.        , 0.95833333, 1.        , 1.        , 1.        ,
         1.        , 1.        , 1.        , 0.95833333, 0.95833333,
         0.95833333, 1.        , 0.95833333, 1.        ]),
  &#39;split4_test_score&#39;: array([0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.95833333,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.95833333, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.95833333, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.95833333, 0.91666667, 0.91666667, 0.91666667, 0.91666667,
         0.91666667, 0.91666667, 0.91666667, 0.91666667]),
  &#39;mean_test_score&#39;: array([0.95      , 0.94166667, 0.93333333, 0.93333333, 0.94166667,
         0.93333333, 0.95      , 0.94166667, 0.95      , 0.95833333,
         0.95      , 0.95      , 0.94166667, 0.94166667, 0.94166667,
         0.94166667, 0.94166667, 0.93333333, 0.96666667, 0.94166667,
         0.95      , 0.94166667, 0.93333333, 0.93333333, 0.93333333,
         0.95      , 0.95      , 0.95      , 0.95      , 0.95      ,
         0.95      , 0.94166667, 0.94166667, 0.93333333, 0.93333333,
         0.93333333, 0.95833333, 0.95      , 0.94166667, 0.95      ,
         0.94166667, 0.94166667, 0.95      , 0.95      , 0.94166667,
         0.96666667, 0.95      , 0.95      , 0.93333333, 0.93333333,
         0.94166667, 0.95      , 0.94166667, 0.95      ]),
  &#39;std_test_score&#39;: array([0.03118048, 0.02041241, 0.02041241, 0.02041241, 0.02041241,
         0.02041241, 0.03118048, 0.02041241, 0.03118048, 0.02635231,
         0.03118048, 0.03118048, 0.02041241, 0.03333333, 0.02041241,
         0.03333333, 0.03333333, 0.02041241, 0.03118048, 0.03333333,
         0.03118048, 0.03333333, 0.02041241, 0.02041241, 0.02041241,
         0.03118048, 0.03118048, 0.03118048, 0.03118048, 0.03118048,
         0.03118048, 0.03333333, 0.03333333, 0.02041241, 0.02041241,
         0.02041241, 0.02635231, 0.03118048, 0.02041241, 0.03118048,
         0.03333333, 0.02041241, 0.03118048, 0.03118048, 0.03333333,
         0.03118048, 0.03118048, 0.03118048, 0.02041241, 0.02041241,
         0.02041241, 0.03118048, 0.02041241, 0.03118048]),
  &#39;rank_test_score&#39;: array([ 5, 25, 43, 43, 25, 43,  5, 25,  5,  3,  5,  5, 25, 34, 25, 34, 34,
         43,  1, 34,  5, 34, 43, 43, 43,  5,  5,  5,  5,  5,  5, 34, 34, 43,
         43, 43,  3,  5, 25,  5, 34, 25,  5,  5, 34,  1,  5,  5, 43, 43, 25,
          5, 25,  5], dtype=int32)},
 &#39;n_splits_&#39;: 5}
</pre></div>
</div>
</div>
</div>
<p>This doesn’t have attributes yet, even though they are the same type, because we have not fit it tot data yet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">svm_opt</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">dt_opt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(sklearn.model_selection._search.GridSearchCV,
 sklearn.model_selection._search.GridSearchCV)
</pre></div>
</div>
</div>
</div>
<p>Now we can fit the model to the training data of this second model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit the model and  put the CV results in a dataframe</span>
<span class="n">svm_opt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris_X_train</span><span class="p">,</span><span class="n">iris_y_train</span><span class="p">)</span>
<span class="n">sv_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">svm_opt</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_fit_time</th>
      <th>std_fit_time</th>
      <th>mean_score_time</th>
      <th>std_score_time</th>
      <th>param_C</th>
      <th>param_kernel</th>
      <th>params</th>
      <th>split0_test_score</th>
      <th>split1_test_score</th>
      <th>split2_test_score</th>
      <th>split3_test_score</th>
      <th>split4_test_score</th>
      <th>split5_test_score</th>
      <th>split6_test_score</th>
      <th>split7_test_score</th>
      <th>split8_test_score</th>
      <th>split9_test_score</th>
      <th>mean_test_score</th>
      <th>std_test_score</th>
      <th>rank_test_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000909</td>
      <td>0.000262</td>
      <td>0.000383</td>
      <td>0.000018</td>
      <td>0.5</td>
      <td>linear</td>
      <td>{'C': 0.5, 'kernel': 'linear'}</td>
      <td>1.0</td>
      <td>0.916667</td>
      <td>0.916667</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.916667</td>
      <td>0.916667</td>
      <td>0.966667</td>
      <td>0.040825</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000970</td>
      <td>0.000120</td>
      <td>0.000422</td>
      <td>0.000024</td>
      <td>0.5</td>
      <td>rbf</td>
      <td>{'C': 0.5, 'kernel': 'rbf'}</td>
      <td>1.0</td>
      <td>0.833333</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.833333</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.916667</td>
      <td>0.916667</td>
      <td>0.950000</td>
      <td>0.066667</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">],</span><span class="n">xerr</span><span class="o">=</span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;std_fit_time&#39;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;mean_score_time&#39;</span><span class="p">],</span><span class="n">yerr</span><span class="o">=</span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;std_score_time&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ErrorbarContainer object of 3 artists&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_35_1.png" src="../_images/2021-11-15_35_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;mean_fit_time&#39;, &#39;std_fit_time&#39;, &#39;mean_score_time&#39;, &#39;std_score_time&#39;,
       &#39;param_C&#39;, &#39;param_kernel&#39;, &#39;params&#39;, &#39;split0_test_score&#39;,
       &#39;split1_test_score&#39;, &#39;split2_test_score&#39;, &#39;split3_test_score&#39;,
       &#39;split4_test_score&#39;, &#39;split5_test_score&#39;, &#39;split6_test_score&#39;,
       &#39;split7_test_score&#39;, &#39;split8_test_score&#39;, &#39;split9_test_score&#39;,
       &#39;mean_test_score&#39;, &#39;std_test_score&#39;, &#39;rank_test_score&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can see if the models that take longer to fit or score perform better.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svm_time</span> <span class="o">=</span> <span class="n">sv_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;param_C&#39;</span><span class="p">,</span> <span class="s1">&#39;param_kernel&#39;</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">,],</span>
                      <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">,</span> <span class="s1">&#39;std_fit_time&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_score_time&#39;</span><span class="p">,</span> <span class="s1">&#39;std_score_time&#39;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mean_fit_time&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">,</span>
          <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;param_kernel&#39;</span><span class="p">,</span><span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7fa41cda93d0&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_38_1.png" src="../_images/2021-11-15_38_1.png" />
</div>
</div>
<p>This looks like mostly no.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mean_score_time&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">,</span>
          <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;param_kernel&#39;</span><span class="p">,</span><span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7fa41d0f6910&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_40_1.png" src="../_images/2021-11-15_40_1.png" />
</div>
</div>
<p>Again, for score time, the slower models don’t appear to be better.  Remember though the time differences weren’t that different.</p>
<div class="admonition-try-it-yourself admonition">
<p class="admonition-title">Try it yourself</p>
<p>Try this same analysis for the decision tree, does it matter there?</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv_df_scores</span> <span class="o">=</span> <span class="n">sv_df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;param_C&#39;</span><span class="p">,</span> <span class="s1">&#39;param_kernel&#39;</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">,],</span>
                    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;split0_test_score&#39;</span><span class="p">,</span>
       <span class="s1">&#39;split1_test_score&#39;</span><span class="p">,</span> <span class="s1">&#39;split2_test_score&#39;</span><span class="p">,</span> <span class="s1">&#39;split3_test_score&#39;</span><span class="p">,</span>
       <span class="s1">&#39;split4_test_score&#39;</span><span class="p">],</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">)</span>
<span class="n">sv_df_scores</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>param_C</th>
      <th>param_kernel</th>
      <th>params</th>
      <th>variable</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.5</td>
      <td>linear</td>
      <td>{'C': 0.5, 'kernel': 'linear'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.5</td>
      <td>rbf</td>
      <td>{'C': 0.5, 'kernel': 'rbf'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.75</td>
      <td>linear</td>
      <td>{'C': 0.75, 'kernel': 'linear'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.75</td>
      <td>rbf</td>
      <td>{'C': 0.75, 'kernel': 'rbf'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>linear</td>
      <td>{'C': 1, 'kernel': 'linear'}</td>
      <td>split0_test_score</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sv_df_scores</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;param_C&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="s1">&#39;param_kernel&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x7fa41f2a05d0&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_43_1.png" src="../_images/2021-11-15_43_1.png" />
</div>
</div>
<div class="admonition-try-it-yourself admonition">
<p class="admonition-title">Try it yourself</p>
<p>Try interpretting the plot above, what does it say? what can you conclude from it.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt_df</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_45_1.png" src="../_images/2021-11-15_45_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sv_df</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/2021-11-15_46_1.png" src="../_images/2021-11-15_46_1.png" />
</div>
</div>
<p>From these last two plots we see that the SVM performance is more sensitive to its parameters, where for the parameters tested, the decision tree is not impacted.</p>
<p>What can we say based on this?  We’ll pick up from here on Wednesday.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="2021-11-12.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">31. </span>SVM and Parameter Optimizing</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2021-11-17.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">33. </span>Model Selection</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Professor Sarah M Brown<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>